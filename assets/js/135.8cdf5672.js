(window.webpackJsonp=window.webpackJsonp||[]).push([[135],{552:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"小部件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小部件"}},[t._v("#")]),t._v(" 小部件")]),t._v(" "),s("p",[t._v("小部件是在"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views",target:"_blank",rel:"noopener noreferrer"}},[t._v("视图"),s("OutboundLink")],1),t._v("中使用的可重用单元， 使用面向对象方式创建复杂和可配置用户界面单元。 例如，日期选择器小部件可生成一个精致的允许用户选择日期的日期选择器， 你只需要在视图中插入如下代码：")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?php\nuse yii\\jui\\DatePicker;\n?>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?= DatePicker::widget(['name' => 'date']) ?>")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("Yii提供许多优秀的小部件，比如 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-widgets-activeform",target:"_blank",rel:"noopener noreferrer"}},[t._v("active form"),s("OutboundLink")],1),t._v("，"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-widgets-menu",target:"_blank",rel:"noopener noreferrer"}},[t._v("menu"),s("OutboundLink")],1),t._v("， "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/widget-jui",target:"_blank",rel:"noopener noreferrer"}},[t._v("jQuery UI widgets"),s("OutboundLink")],1),t._v("， "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/widget-bootstrap",target:"_blank",rel:"noopener noreferrer"}},[t._v("Twitter Bootstrap widgets"),s("OutboundLink")],1),t._v("。 接下来介绍小部件的基本知识，如果你想了解某个小部件 please refer to 对应的类 API 文档。")]),t._v(" "),s("h2",{attrs:{id:"使用小部件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用小部件"}},[t._v("#")]),t._v(" 使用小部件")]),t._v(" "),s("p",[t._v("小部件基本上在 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views",target:"_blank",rel:"noopener noreferrer"}},[t._v("views"),s("OutboundLink")],1),t._v(" 中使用， 在视图中可调用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#widget()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::widget()"),s("OutboundLink")],1),t._v(" 方法使用小部件。 该方法使用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/concept-configurations",target:"_blank",rel:"noopener noreferrer"}},[t._v("配置"),s("OutboundLink")],1),t._v(" 数组初始化小部件并返回小部件渲染后的结果。 例如如下代码插入一个日期选择器小部件，它配置为使用俄罗斯语， 输入框内容为 "),s("code",[t._v("$model")]),t._v(" 的 "),s("code",[t._v("from_date")]),t._v(" 属性值。")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?php\nuse yii\\jui\\DatePicker;\n?>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?= DatePicker::widget([\n    'model' => $model,\n    'attribute' => 'from_date',\n    'language' => 'ru',\n    'dateFormat' => 'php:Y-m-d',\n]) ?>")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("p",[t._v("一些小部件可在 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#begin()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::begin()"),s("OutboundLink")],1),t._v(" 和 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#end()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::end()"),s("OutboundLink")],1),t._v(" 调用中使用数据内容。 例如如下代码使用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-widgets-activeform",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\widgets\\ActiveForm"),s("OutboundLink")],1),t._v(" 小部件生成一个登录表单， 小部件会在 "),s("code",[t._v("begin()")]),t._v(" 和 "),s("code",[t._v("end()")]),t._v(" 执行处分别生成 "),s("code",[t._v("<form>")]),t._v(" 的开始标签和结束标签， 中间的任何代码也会被渲染。")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?php\nuse yii\\widgets\\ActiveForm;\nuse yii\\helpers\\Html;\n?>")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?php $form = ActiveForm::begin(['id' => 'login-form']); ?>")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?= $form->field($model, 'username') ?>")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?= $form->field($model, 'password')->passwordInput() ?>")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("form-group"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?= Html::submitButton('Login') ?>")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?php ActiveForm::end(); ?>")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("p",[t._v("注意和调用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#widget()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::widget()"),s("OutboundLink")],1),t._v(" 返回渲染结果不同， 调用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#begin()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::begin()"),s("OutboundLink")],1),t._v(" 方法返回一个可组建小部件内容的小部件实例。")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("注意：")]),t._v(" 当调用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#end()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::end()"),s("OutboundLink")],1),t._v(" 的时候，一些小部件将使用 "),s("a",{attrs:{href:"https://www.php.net/manual/zh/book.outcontrol.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("输出缓冲"),s("OutboundLink")],1),t._v(" 来调整封闭的内容。因此，当调用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#begin()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::begin()"),s("OutboundLink")],1),t._v(" 和 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#end()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::end()"),s("OutboundLink")],1),t._v(" 时，最好在同一个视图文件里。 不遵循这个规则可能会导致意外的输出。")])]),t._v(" "),s("h3",{attrs:{id:"配置全局默认值"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置全局默认值"}},[t._v("#")]),t._v(" 配置全局默认值")]),t._v(" "),s("p",[t._v("小部件的全局默认值可以通过 DI 容器配置：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified static-context"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Yii")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$container")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'yii\\widgets\\LinkPager'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'maxButtonCount'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("有关详细信息，请参阅 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/concept-di-container#practical-usage",target:"_blank",rel:"noopener noreferrer"}},[t._v("依赖注入容器“实践中的应用”一节"),s("OutboundLink")],1),t._v(" 。")]),t._v(" "),s("h2",{attrs:{id:"创建小部件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建小部件"}},[t._v("#")]),t._v(" 创建小部件")]),t._v(" "),s("p",[t._v("可以根据需要以两种不同方式创建小部件。")]),t._v(" "),s("h3",{attrs:{id:"_1-使用-widget-方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-使用-widget-方法"}},[t._v("#")]),t._v(" 1: 使用 "),s("code",[t._v("widget()")]),t._v(" 方法")]),t._v(" "),s("p",[t._v("继承 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget"),s("OutboundLink")],1),t._v(" 类并覆盖 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#init()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::init()"),s("OutboundLink")],1),t._v(" 和/或 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#run()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::run()"),s("OutboundLink")],1),t._v(" 方法可创建小部件。通常 "),s("code",[t._v("init()")]),t._v(" 方法处理小部件属性， "),s("code",[t._v("run()")]),t._v(" 方法包含小部件生成渲染结果的代码。 渲染结果可以直接“输出”或通过 "),s("code",[t._v("run()")]),t._v(" 方法作为字符串返回。")]),t._v(" "),s("p",[t._v("如下代码中 "),s("code",[t._v("HelloWidget")]),t._v(" 编码并显示赋给 "),s("code",[t._v("message")]),t._v(' 属性的值， 如果属性没有被赋值，默认会显示 "Hello World"。')]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("components")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("base"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Widget")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("helpers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("HelloWidget")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Widget")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$message")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword static-context"}},[t._v("parent")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("message")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("message")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'Hello World'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Html")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("encode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br")])]),s("p",[t._v("使用这个小部件只需在视图中简单使用如下代码:")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?php\nuse app\\components\\HelloWidget;\n?>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v("<?= HelloWidget::widget(['message' => 'Good morning']) ?>")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("有时小部件需要渲染很多内容，虽然你可以在 "),s("code",[t._v("run()")]),t._v(" 方法中嵌入内容，但更好的方法是将内容放入一个"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views",target:"_blank",rel:"noopener noreferrer"}},[t._v("视图"),s("OutboundLink")],1),t._v("文件， 然后调用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#render()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::render()"),s("OutboundLink")],1),t._v(" 方法渲染该视图文件， 例如：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'hello'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"_2-使用-begin-和-end-方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用-begin-和-end-方法"}},[t._v("#")]),t._v(" 2: 使用 "),s("code",[t._v("begin()")]),t._v(" 和 "),s("code",[t._v("end()")]),t._v(" 方法")]),t._v(" "),s("p",[t._v("这类似于上面的有细微差别。 以下是另一种可在 "),s("code",[t._v("begin()")]),t._v(" 和 "),s("code",[t._v("end()")]),t._v(" 调用中使用的 "),s("code",[t._v("HelloWidget")]),t._v("， HTML 编码内容然后显示。")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("components")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("base"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Widget")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("helpers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("HelloWidget")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Widget")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword static-context"}},[t._v("parent")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ob_start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$content")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ob_get_clean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Html")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("encode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("p",[t._v("如上所示，PHP 输出缓冲在 "),s("code",[t._v("init()")]),t._v(" 启动，所有在 "),s("code",[t._v("init()")]),t._v(" 和 "),s("code",[t._v("run()")]),t._v(" 方法之间的输出内容都会被获取，并在 "),s("code",[t._v("run()")]),t._v(" 处理和返回。")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("信息：")]),t._v(" 当你调用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#begin()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::begin()"),s("OutboundLink")],1),t._v(" 时会创建一个新的小部件 实例并在构造结束时调用 "),s("code",[t._v("init()")]),t._v(" 方法， 在 "),s("code",[t._v("end()")]),t._v(" 时会调用 "),s("code",[t._v("run()")]),t._v(" 方法并输出返回结果。")])]),t._v(" "),s("p",[t._v("如下代码显示如何使用这种 "),s("code",[t._v("HelloWidget")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("components"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("HelloWidget")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("HelloWidget")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("begin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n\n    sample content that may contain one or more "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("strong")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("HTML"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("strong")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("pre")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("tags"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("pre")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n    If this content grows too big, use sub views\n\n    For e.g.\n\n    "),s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'viewfile'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Note: here render() method is of class \\yii\\base\\View as this part of code is within view file and not in Widget class file ")]),s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("HelloWidget")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br")])]),s("p",[t._v("默认情况下，小部件的视图应存储在 "),s("code",[t._v("WidgetPath/views")]),t._v(" 目录，"),s("code",[t._v("WidgetPath")]),t._v(" 代表小部件类文件所在的目录。 假如小部件类文件在 "),s("code",[t._v("@app/components")]),t._v(" 下， 上述示例会渲染 "),s("code",[t._v("@app/components/views/hello.php")]),t._v(" 视图文件。 您可以覆盖 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-widget#getViewPath()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Widget::getViewPath()"),s("OutboundLink")],1),t._v(" 方法自定义视图文件所在路径。")]),t._v(" "),s("h2",{attrs:{id:"最佳实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),s("p",[t._v("小部件是面向对象方式来重用视图代码。")]),t._v(" "),s("p",[t._v("创建小部件时仍需要遵循MVC模式，通常逻辑代码在小部件类， 展示内容在"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views",target:"_blank",rel:"noopener noreferrer"}},[t._v("视图"),s("OutboundLink")],1),t._v("中。")]),t._v(" "),s("p",[t._v("小部件设计时应是独立的，也就是说使用一个小部件时候， 可以直接丢弃它而不需要额外的处理。 但是当小部件需要外部资源如 CSS，JavaScript，图片等会比较棘手， 幸运的时候Yii提供 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-asset-bundles",target:"_blank",rel:"noopener noreferrer"}},[t._v("资源包"),s("OutboundLink")],1),t._v(" 来解决这个问题。")]),t._v(" "),s("p",[t._v("当一个小部件只包含视图代码，它和"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views",target:"_blank",rel:"noopener noreferrer"}},[t._v("视图"),s("OutboundLink")],1),t._v("很相似， 实际上，在这种情况下，唯一的区别是小部件是可以重用类， 视图只是应用中使用的普通 PHP 脚本。")])])}),[],!1,null,null,null);s.default=e.exports}}]);