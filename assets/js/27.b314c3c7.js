(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{441:function(a,t,s){"use strict";s.r(t);var e=s(2),n=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"knative-驱动的企业级-serverless-落地指南"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#knative-驱动的企业级-serverless-落地指南"}},[a._v("#")]),a._v(" Knative 驱动的企业级 Serverless 落地指南")]),a._v(" "),t("blockquote",[t("p",[a._v("预计阅读时间：10 分钟")])]),a._v(" "),t("h2",{attrs:{id:"_1-来源"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-来源"}},[a._v("#")]),a._v(" 1. 来源")]),a._v(" "),t("p",[a._v("文章参考了 Knative 官方文档、Google/VMware 的架构分享，以及我们在呼叫中心智能语音服务中从函数平台迁移到 Knative 的经验。")]),a._v(" "),t("h2",{attrs:{id:"_2-市场现状"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-市场现状"}},[a._v("#")]),a._v(" 2. 市场现状")]),a._v(" "),t("ul",[t("li",[a._v("公有云 FaaS 在企业内部落地时常遇到 "),t("strong",[a._v("数据主权")]),a._v(" 与 "),t("strong",[a._v("成本")]),a._v(" 问题。")]),a._v(" "),t("li",[a._v("传统 PaaS 很难应对峰值突发，资源利用率低。")]),a._v(" "),t("li",[a._v("越来越多团队希望在 Kubernetes 上搭建自研 Serverless，统一运维与生态。")])]),a._v(" "),t("h2",{attrs:{id:"_3-knative-核心组件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-knative-核心组件"}},[a._v("#")]),a._v(" 3. Knative 核心组件")]),a._v(" "),t("ul",[t("li",[t("strong",[a._v("Serving")]),a._v("：按需伸缩、流量治理、修订版本管理。")]),a._v(" "),t("li",[t("strong",[a._v("Eventing")]),a._v("：事件总线，支持 CloudEvents 标准与多种 Broker/Trigger。")]),a._v(" "),t("li",[t("strong",[a._v("Build")]),a._v("（已拆分）与 Tekton 等工具可用于 CI/CD。")])]),a._v(" "),t("div",{staticClass:"language-mermaid line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-mermaid"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("graph")]),a._v(" LR\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("subgraph")]),a._v(" Serving\n    Service "),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")]),a._v(" Configuration\n    Configuration "),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")]),a._v(" Revision\n    Revision "),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")]),a._v(" Route\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("end")]),a._v("\n    Route "),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")]),a._v(" PodAutoscaler\n    PodAutoscaler "),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")]),a._v(" K8sDeployment\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("subgraph")]),a._v(" Eventing\n    Broker "),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")]),a._v(" Trigger\n    Trigger "),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")]),a._v(" Consumer\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("end")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br")])]),t("h2",{attrs:{id:"_4-架构设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-架构设计"}},[a._v("#")]),a._v(" 4. 架构设计")]),a._v(" "),t("ul",[t("li",[t("strong",[a._v("资源规划")]),a._v("：为 Knative Serving 准备独立节点池，开启 "),t("code",[a._v("pod autoscaler")]),a._v(" 的并发限制。")]),a._v(" "),t("li",[t("strong",[a._v("镜像构建")]),a._v("：通过 Tekton Pipeline + Kaniko 生成镜像，推送至 Harbor。")]),a._v(" "),t("li",[t("strong",[a._v("网络入口")]),a._v("：结合 Istio/Contour 作为网关，支持 mTLS。")])]),a._v(" "),t("h2",{attrs:{id:"_5-部署示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-部署示例"}},[a._v("#")]),a._v(" 5. 部署示例")]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" serving.knative.dev/v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" speech"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("text\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" ai"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("platform\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("template")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("annotations")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("autoscaling.knative.dev/class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" kpa.autoscaling.knative.dev\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("autoscaling.knative.dev/metric")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" concurrency\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("autoscaling.knative.dev/target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"5"')]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("autoscaling.knative.dev/maxScale")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"50"')]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" registry.example.com/ai/speech"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("text"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("v2\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" MODEL_ENDPOINT\n              "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//model"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("serving"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("traffic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("latestRevision")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("percent")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("90")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("revisionName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" speech"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("text"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("00018")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("percent")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br"),t("span",{staticClass:"line-number"},[a._v("20")]),t("br"),t("span",{staticClass:"line-number"},[a._v("21")]),t("br"),t("span",{staticClass:"line-number"},[a._v("22")]),t("br"),t("span",{staticClass:"line-number"},[a._v("23")]),t("br"),t("span",{staticClass:"line-number"},[a._v("24")]),t("br")])]),t("ul",[t("li",[t("strong",[a._v("渐进式发布")]),a._v("：借助 "),t("code",[a._v("traffic")]),a._v(" 字段完成灰度。")]),a._v(" "),t("li",[t("strong",[a._v("并发控制")]),a._v("：target=5 表示每个 Pod 最大处理 5 个并发请求。")])]),a._v(" "),t("h2",{attrs:{id:"_6-事件驱动实践"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-事件驱动实践"}},[a._v("#")]),a._v(" 6. 事件驱动实践")]),a._v(" "),t("ul",[t("li",[a._v("使用 CloudEvents 规范接入 CRM、语音识别等事件源。")]),a._v(" "),t("li",[a._v("Eventing 结合 Kafka Broker，实现百万级事件吞吐。")]),a._v(" "),t("li",[a._v("通过 Trigger + CEL 表达式路由，实现差异化处理逻辑。")])]),a._v(" "),t("h2",{attrs:{id:"_7-成本与性能优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-成本与性能优化"}},[a._v("#")]),a._v(" 7. 成本与性能优化")]),a._v(" "),t("ul",[t("li",[t("strong",[a._v("冷启动优化")]),a._v("：利用 "),t("code",[a._v("queueProxy")]),a._v(" 指标分析冷启动耗时，热点函数常驻运行；启用 "),t("code",[a._v("minScale")]),a._v(" 确保核心服务无冷启动。")]),a._v(" "),t("li",[t("strong",[a._v("镜像瘦身")]),a._v("：采用 Distroless/Alpine，使用多阶段构建减小镜像体积。")]),a._v(" "),t("li",[t("strong",[a._v("自动扩缩容")]),a._v("：KPA 支持指标驱动伸缩，Autoscaler 与自研容量平台打通，实现业务高峰自动加容。")])]),a._v(" "),t("h2",{attrs:{id:"_8-业务结合案例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-业务结合案例"}},[a._v("#")]),a._v(" 8. 业务结合案例")]),a._v(" "),t("p",[a._v("在智能语音外呼项目中：")]),a._v(" "),t("ol",[t("li",[a._v("将原有的手工扩缩容服务迁移至 Knative，按并发自动伸缩，成本下降 30%。")]),a._v(" "),t("li",[a._v("事件管道将通话结果推送到风控系统，触发后续贷款审批流程。")]),a._v(" "),t("li",[a._v("借助 Tekton + Knative 实现模型版本的一键上线回滚。")])]),a._v(" "),t("h2",{attrs:{id:"_9-运维治理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-运维治理"}},[a._v("#")]),a._v(" 9. 运维治理")]),a._v(" "),t("ul",[t("li",[a._v("使用 KEDA 监控 Kafka Lag，实现事件驱动伸缩。")]),a._v(" "),t("li",[a._v("集成 OpenTelemetry，追踪调用链路与冷启动耗时。")]),a._v(" "),t("li",[a._v("制定治理策略：限定每个命名空间的并发上限、防止滥用。")])]),a._v(" "),t("h2",{attrs:{id:"_10-进一步阅读"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-进一步阅读"}},[a._v("#")]),a._v(" 10. 进一步阅读")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://knative.dev/docs/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Knative Docs"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/knative/docs/tree/main/code-samples/eventing",target:"_blank",rel:"noopener noreferrer"}},[a._v("Knative Eventing Samples"),t("OutboundLink")],1)]),a._v(" "),t("li",[a._v("[Google Cloud Blog: Knative in Production]")])]),a._v(" "),t("p",[a._v("Knative 让企业既能享受 Serverless 的敏捷，又能掌控基础设施与数据，在数智化升级过程中提供弹性、高可用的执行环境。")])])}),[],!1,null,null,null);t.default=n.exports}}]);