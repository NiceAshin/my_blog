(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{559:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"控制器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#控制器"}},[t._v("#")]),t._v(" 控制器")]),t._v(" "),s("p",[t._v("控制器是 "),s("a",{attrs:{href:"https://zh.wikipedia.org/wiki/MVC",target:"_blank",rel:"noopener noreferrer"}},[t._v("MVC"),s("OutboundLink")],1),t._v(" 模式中的一部分， 是继承"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-controller",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Controller"),s("OutboundLink")],1),t._v("类的对象，负责处理请求和生成响应。 具体来说，控制器从"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-applications",target:"_blank",rel:"noopener noreferrer"}},[t._v("应用主体"),s("OutboundLink")],1),t._v(" 接管控制后会分析请求数据并传送到"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-models",target:"_blank",rel:"noopener noreferrer"}},[t._v("模型"),s("OutboundLink")],1),t._v("， 传送模型结果到"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views",target:"_blank",rel:"noopener noreferrer"}},[t._v("视图"),s("OutboundLink")],1),t._v("，最后生成输出响应信息。")]),t._v(" "),s("h2",{attrs:{id:"动作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动作"}},[t._v("#")]),t._v(" 动作")]),t._v(" "),s("p",[t._v("控制器由 "),s("em",[t._v("操作")]),t._v(" 组成，它是执行终端用户请求的最基础的单元， 一个控制器可有一个或多个操作。")]),t._v(" "),s("p",[t._v("如下示例显示包含两个动作"),s("code",[t._v("view")]),t._v(" and "),s("code",[t._v("create")]),t._v(" 的控制器"),s("code",[t._v("post")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("controllers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("Yii")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("models"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("web"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Controller")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("web"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("NotFoundHttpException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("PostController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Controller")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("actionView")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Post")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findOne")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NotFoundHttpException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'view'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'model'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("actionCreate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("load")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Yii")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$app")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("request")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("redirect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'view'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'id'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'create'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'model'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br")])]),s("p",[t._v("在操作 "),s("code",[t._v("view")]),t._v(" (定义为 "),s("code",[t._v("actionView()")]),t._v(" 方法)中， 代码首先根据请求模型ID加载 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-models",target:"_blank",rel:"noopener noreferrer"}},[t._v("模型"),s("OutboundLink")],1),t._v("， 如果加载成功，会渲染名称为"),s("code",[t._v("view")]),t._v("的"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views",target:"_blank",rel:"noopener noreferrer"}},[t._v("视图"),s("OutboundLink")],1),t._v("并显示，否则会抛出一个异常。")]),t._v(" "),s("p",[t._v("在操作 "),s("code",[t._v("create")]),t._v(" (定义为 "),s("code",[t._v("actionCreate()")]),t._v(" 方法)中, 代码相似. 先将请求数据填入"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-models",target:"_blank",rel:"noopener noreferrer"}},[t._v("模型"),s("OutboundLink")],1),t._v("， 然后保存模型，如果两者都成功，会跳转到ID为新创建的模型的"),s("code",[t._v("view")]),t._v("操作， 否则显示提供用户输入的"),s("code",[t._v("create")]),t._v("视图。")]),t._v(" "),s("h2",{attrs:{id:"路由"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#路由"}},[t._v("#")]),t._v(" 路由")]),t._v(" "),s("p",[t._v("终端用户通过所谓的"),s("em",[t._v("路由")]),t._v("寻找到动作，路由是包含以下部分的字符串：")]),t._v(" "),s("ul",[s("li",[t._v("模块ID: 仅存在于控制器属于非应用的"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-modules",target:"_blank",rel:"noopener noreferrer"}},[t._v("模块"),s("OutboundLink")],1),t._v(";")]),t._v(" "),s("li",[t._v("控制器ID: 同应用（或同模块如果为模块下的控制器） 下唯一标识控制器的字符串;")]),t._v(" "),s("li",[t._v("操作ID: 同控制器下唯一标识操作的字符串。")])]),t._v(" "),s("p",[t._v("路由使用如下格式:")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ControllerID/ActionID\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("如果属于模块下的控制器，使用如下格式：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[t._v("ModuleID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ControllerID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ActionID\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("如果用户的请求地址为 "),s("code",[t._v("https://hostname/index.php?r=site/index")]),t._v(", 会执行"),s("code",[t._v("site")]),t._v(" 控制器的"),s("code",[t._v("index")]),t._v(" 操作。 更多关于处理路由的详情请参阅 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/runtime-routing",target:"_blank",rel:"noopener noreferrer"}},[t._v("路由"),s("OutboundLink")],1),t._v(" 一节。")]),t._v(" "),s("h2",{attrs:{id:"创建控制器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建控制器"}},[t._v("#")]),t._v(" 创建控制器")]),t._v(" "),s("p",[t._v("在"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-application",target:"_blank",rel:"noopener noreferrer"}},[t._v("Web applications"),s("OutboundLink")],1),t._v("网页应用中，控制器应继承"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-controller",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\web\\Controller"),s("OutboundLink")],1),t._v(" 或它的子类。 同理在"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-console-application",target:"_blank",rel:"noopener noreferrer"}},[t._v("console applications"),s("OutboundLink")],1),t._v("控制台应用中，控制器继承"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-console-controller",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\console\\Controller"),s("OutboundLink")],1),t._v(" 或它的子类。 如下代码定义一个 "),s("code",[t._v("site")]),t._v(" 控制器:")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("controllers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("web"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Controller")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("SiteController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Controller")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("h3",{attrs:{id:"控制器id"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#控制器id"}},[t._v("#")]),t._v(" 控制器ID")]),t._v(" "),s("p",[t._v("通常情况下，控制器用来处理请求有关的资源类型， 因此控制器ID通常为和资源有关的名词。 例如使用"),s("code",[t._v("article")]),t._v("作为处理文章的控制器ID。")]),t._v(" "),s("p",[t._v("控制器ID应仅包含英文小写字母、数字、下划线、中横杠和正斜杠， 例如 "),s("code",[t._v("article")]),t._v(" 和 "),s("code",[t._v("post-comment")]),t._v(" 是真是的控制器ID， "),s("code",[t._v("article?")]),t._v(", "),s("code",[t._v("PostComment")]),t._v(", "),s("code",[t._v("admin\\post")]),t._v("不是控制器ID。")]),t._v(" "),s("p",[t._v("控制器Id可包含子目录前缀，例如 "),s("code",[t._v("admin/article")]),t._v(" 代表 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-application#$controllerNamespace-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("controller namespace"),s("OutboundLink")],1),t._v(" 控制器命名空间下 "),s("code",[t._v("admin")]),t._v("子目录中 "),s("code",[t._v("article")]),t._v(" 控制器。 子目录前缀可为英文大小写字母、数字、下划线、正斜杠，其中正斜杠用来区分多级子目录(如 "),s("code",[t._v("panels/admin")]),t._v(")。")]),t._v(" "),s("h3",{attrs:{id:"控制器类命名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#控制器类命名"}},[t._v("#")]),t._v(" 控制器类命名")]),t._v(" "),s("p",[t._v("控制器ID遵循以下规则衍生控制器类名：")]),t._v(" "),s("ol",[s("li",[t._v("将用正斜杠区分的每个单词第一个字母转为大写。注意如果控制器ID包含正斜杠， 只将最后的正斜杠后的部分第一个字母转为大写；")]),t._v(" "),s("li",[t._v("去掉中横杠，将正斜杠替换为反斜杠;")]),t._v(" "),s("li",[t._v("增加"),s("code",[t._v("Controller")]),t._v("后缀;")]),t._v(" "),s("li",[t._v("在前面增加"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-application#$controllerNamespace-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("controller namespace"),s("OutboundLink")],1),t._v("控制器命名空间.")])]),t._v(" "),s("p",[t._v("下面为一些示例，假设"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-application#$controllerNamespace-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("controller namespace"),s("OutboundLink")],1),t._v(" 控制器命名空间为 "),s("code",[t._v("app\\controllers")]),t._v(":")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("article")]),t._v(" 对应 "),s("code",[t._v("app\\controllers\\ArticleController")]),t._v(";")]),t._v(" "),s("li",[s("code",[t._v("post-comment")]),t._v(" 对应 "),s("code",[t._v("app\\controllers\\PostCommentController")]),t._v(";")]),t._v(" "),s("li",[s("code",[t._v("admin/post-comment")]),t._v(" 对应 "),s("code",[t._v("app\\controllers\\admin\\PostCommentController")]),t._v(";")]),t._v(" "),s("li",[s("code",[t._v("adminPanels/post-comment")]),t._v(" 对应 "),s("code",[t._v("app\\controllers\\adminPanels\\PostCommentController")]),t._v(".")])]),t._v(" "),s("p",[t._v("控制器类必须能被 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/concept-autoloading",target:"_blank",rel:"noopener noreferrer"}},[t._v("自动加载"),s("OutboundLink")],1),t._v("，所以在上面的例子中， 控制器"),s("code",[t._v("article")]),t._v(" 类应在 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/concept-aliases",target:"_blank",rel:"noopener noreferrer"}},[t._v("别名"),s("OutboundLink")],1),t._v(" 为"),s("code",[t._v("@app/controllers/ArticleController.php")]),t._v("的文件中定义， 控制器"),s("code",[t._v("admin/post-comment")]),t._v("应在"),s("code",[t._v("@app/controllers/admin/PostCommentController.php")]),t._v("文件中。")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("信息：")]),t._v(" 最后一个示例 "),s("code",[t._v("admin/post-comment")]),t._v(" 表示你可以将控制器放在 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-application#$controllerNamespace-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("controller namespace"),s("OutboundLink")],1),t._v("控制器命名空间下的子目录中， 在你不想用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-modules",target:"_blank",rel:"noopener noreferrer"}},[t._v("模块"),s("OutboundLink")],1),t._v(" 的情况下给控制器分类，这种方式很有用。")])]),t._v(" "),s("h3",{attrs:{id:"控制器部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#控制器部署"}},[t._v("#")]),t._v(" 控制器部署")]),t._v(" "),s("p",[t._v("可通过配置 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-module#$controllerMap-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("controller map"),s("OutboundLink")],1),t._v(" 来强制上述的控制器ID和类名对应， 通常用在使用第三方不能掌控类名的控制器上。")]),t._v(" "),s("p",[t._v("配置 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-applications#application-configurations",target:"_blank",rel:"noopener noreferrer"}},[t._v("应用配置"),s("OutboundLink")],1),t._v(" 中的"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-applications#application-configurations",target:"_blank",rel:"noopener noreferrer"}},[t._v("application configuration"),s("OutboundLink")],1),t._v("，如下所示：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'controllerMap'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// 用类名申明 "account" 控制器')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'account'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'app\\controllers\\UserController'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// 用配置数组申明 "article" 控制器')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'article'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'class'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'app\\controllers\\PostController'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'enableCsrfValidation'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("h3",{attrs:{id:"默认控制器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#默认控制器"}},[t._v("#")]),t._v(" 默认控制器")]),t._v(" "),s("p",[t._v("每个应用有一个由"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-module#$defaultRoute-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Application::$defaultRoute"),s("OutboundLink")],1),t._v("属性指定的默认控制器； 当请求没有指定 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-controllers#ids-routes",target:"_blank",rel:"noopener noreferrer"}},[t._v("路由"),s("OutboundLink")],1),t._v("，该属性值作为路由使用。 对于"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-application",target:"_blank",rel:"noopener noreferrer"}},[t._v("Web applications"),s("OutboundLink")],1),t._v("网页应用，它的值为 "),s("code",[t._v("'site'")]),t._v("，对于 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-console-application",target:"_blank",rel:"noopener noreferrer"}},[t._v("console applications"),s("OutboundLink")],1),t._v(" 控制台应用，它的值为 "),s("code",[t._v("help")]),t._v("，所以URL为 "),s("code",[t._v("https://hostname/index.php")]),t._v(" 表示由 "),s("code",[t._v("site")]),t._v(" 控制器来处理。")]),t._v(" "),s("p",[t._v("可以在 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-applications#application-configurations",target:"_blank",rel:"noopener noreferrer"}},[t._v("应用配置"),s("OutboundLink")],1),t._v(" 中修改默认控制器，如下所示：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'defaultRoute'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'main'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h2",{attrs:{id:"创建动作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建动作"}},[t._v("#")]),t._v(" 创建动作")]),t._v(" "),s("p",[t._v("创建操作可简单地在控制器类中定义所谓的 "),s("em",[t._v("操作方法")]),t._v(" 来完成，操作方法必须是以"),s("code",[t._v("action")]),t._v("开头的公有方法。 操作方法的返回值会作为响应数据发送给终端用户， 如下代码定义了两个操作 "),s("code",[t._v("index")]),t._v(" 和 "),s("code",[t._v("hello-world")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("controllers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("web"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Controller")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("SiteController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Controller")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("actionIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'index'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("actionHelloWorld")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'Hello World'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("h3",{attrs:{id:"动作id"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动作id"}},[t._v("#")]),t._v(" 动作ID")]),t._v(" "),s("p",[t._v("操作通常是用来执行资源的特定操作，因此， 操作ID通常为动词，如"),s("code",[t._v("view")]),t._v(", "),s("code",[t._v("update")]),t._v("等。")]),t._v(" "),s("p",[t._v("操作ID应仅包含英文小写字母、数字、下划线和中横杠，操作ID中的中横杠用来分隔单词。 例如"),s("code",[t._v("view")]),t._v(", "),s("code",[t._v("update2")]),t._v(", "),s("code",[t._v("comment-post")]),t._v("是真实的操作ID， "),s("code",[t._v("view?")]),t._v(", "),s("code",[t._v("Update")]),t._v("不是操作ID.")]),t._v(" "),s("p",[t._v("可通过两种方式创建操作ID，内联操作和独立操作. An inline action is 内联操作在控制器类中定义为方法；独立操作是继承"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Action"),s("OutboundLink")],1),t._v("或它的子类的类。 内联操作容易创建，在无需重用的情况下优先使用； 独立操作相反，主要用于多个控制器重用， 或重构为"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-extensions",target:"_blank",rel:"noopener noreferrer"}},[t._v("扩展"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"内联动作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#内联动作"}},[t._v("#")]),t._v(" 内联动作")]),t._v(" "),s("p",[t._v("内联动作指的是根据我们刚描述的操作方法。")]),t._v(" "),s("p",[t._v("动作方法的名字是根据操作ID遵循如下规则衍生：")]),t._v(" "),s("ol",[s("li",[t._v("将每个单词的第一个字母转为大写;")]),t._v(" "),s("li",[t._v("去掉中横杠;")]),t._v(" "),s("li",[t._v("增加"),s("code",[t._v("action")]),t._v("前缀.")])]),t._v(" "),s("p",[t._v("例如"),s("code",[t._v("index")]),t._v(" 转成 "),s("code",[t._v("actionIndex")]),t._v(", "),s("code",[t._v("hello-world")]),t._v(" 转成 "),s("code",[t._v("actionHelloWorld")]),t._v("。")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("注意：")]),t._v(" 操作方法的名字"),s("em",[t._v("大小写敏感")]),t._v("，如果方法名称为"),s("code",[t._v("ActionIndex")]),t._v("不会认为是操作方法， 所以请求"),s("code",[t._v("index")]),t._v("操作会返回一个异常， 也要注意操作方法必须是公有的， 私有或者受保护的方法不能定义成内联操作。")])]),t._v(" "),s("p",[t._v("因为容易创建，内联操作是最常用的操作， 但是如果你计划在不同地方重用相同的操作， 或者你想重新分配一个操作，需要考虑定义它为"),s("em",[t._v("独立操作")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"独立动作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#独立动作"}},[t._v("#")]),t._v(" 独立动作")]),t._v(" "),s("p",[t._v("独立操作通过继承"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Action"),s("OutboundLink")],1),t._v("或它的子类来定义。 例如Yii发布的"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-viewaction",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\web\\ViewAction"),s("OutboundLink")],1),t._v(" 和"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-erroraction",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\web\\ErrorAction"),s("OutboundLink")],1),t._v("都是独立操作。")]),t._v(" "),s("p",[t._v("要使用独立操作，需要通过控制器中覆盖"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-controller#actions()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Controller::actions()"),s("OutboundLink")],1),t._v("方法在"),s("em",[t._v("action map")]),t._v("中申明， 如下例所示：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("actions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// 用类来申明"error" 动作')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'error'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'yii\\web\\ErrorAction'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// 用配置数组申明 "view" 动作')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'view'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'class'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'yii\\web\\ViewAction'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'viewPrefix'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[t._v("如上所示， "),s("code",[t._v("actions()")]),t._v(" 方法返回键为操作ID、值为对应操作类名 或数组"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/concept-configurations",target:"_blank",rel:"noopener noreferrer"}},[t._v("configurations"),s("OutboundLink")],1),t._v(" 的数组。 和内联操作不同，独立操作ID可包含任意字符，只要在"),s("code",[t._v("actions()")]),t._v(" 方法中申明.")]),t._v(" "),s("p",[t._v("为创建一个独立操作类，需要继承"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Action"),s("OutboundLink")],1),t._v(" 或它的子类，并实现公有的名称为"),s("code",[t._v("run()")]),t._v("的方法, "),s("code",[t._v("run()")]),t._v(" 方法的角色和操作方法类似，例如：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("components")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("base"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Action")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("HelloWorldAction")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Action")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"Hello World"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("h3",{attrs:{id:"动作结果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动作结果"}},[t._v("#")]),t._v(" 动作结果")]),t._v(" "),s("p",[t._v("操作方法或独立操作的"),s("code",[t._v("run()")]),t._v("方法的返回值非常重要， 它表示对应操作结果。")]),t._v(" "),s("p",[t._v("返回值可为 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/runtime-responses",target:"_blank",rel:"noopener noreferrer"}},[t._v("响应"),s("OutboundLink")],1),t._v(" 对象，作为响应发送给终端用户。")]),t._v(" "),s("ul",[s("li",[t._v("对于"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-application",target:"_blank",rel:"noopener noreferrer"}},[t._v("Web applications"),s("OutboundLink")],1),t._v("网页应用，返回值可为任意数据, 它赋值给"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-response#$data-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\web\\Response::$data"),s("OutboundLink")],1),t._v("， 最终转换为字符串来展示响应内容。")]),t._v(" "),s("li",[t._v("对于"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-console-application",target:"_blank",rel:"noopener noreferrer"}},[t._v("console applications"),s("OutboundLink")],1),t._v("控制台应用，返回值可为整数， 表示命令行下执行的 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-response#$exitStatus-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("exit status"),s("OutboundLink")],1),t._v(" 退出状态。")])]),t._v(" "),s("p",[t._v("在上面的例子中，操作结果都为字符串，作为响应数据发送给终端用户， 下例显示一个操作通过 返回响应对象（因为"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-controller#redirect()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("redirect()"),s("OutboundLink")],1),t._v("方法返回一个响应对象） 可将用户浏览器跳转到新的URL。")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("actionForward")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用户浏览器跳转到 https://example.com")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("redirect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'https://example.com'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("h3",{attrs:{id:"动作参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动作参数"}},[t._v("#")]),t._v(" 动作参数")]),t._v(" "),s("p",[t._v("内联动作的操作方法和独立动作的 "),s("code",[t._v("run()")]),t._v(" 方法可以带参数，称为"),s("em",[t._v("动作参数")]),t._v("。 参数值从请求中获取，对于"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-application",target:"_blank",rel:"noopener noreferrer"}},[t._v("Web applications"),s("OutboundLink")],1),t._v("网页应用， 每个动作参数的值从"),s("code",[t._v("$_GET")]),t._v("中获得，参数名作为键； 对于"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-console-application",target:"_blank",rel:"noopener noreferrer"}},[t._v("console applications"),s("OutboundLink")],1),t._v("控制台应用, 动作参数对应命令行参数。")]),t._v(" "),s("p",[t._v("如下例，动作"),s("code",[t._v("view")]),t._v(" (内联动作) 申明了两个参数 "),s("code",[t._v("$id")]),t._v(" 和 "),s("code",[t._v("$version")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("controllers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("web"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Controller")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("PostController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Controller")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("actionView")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$version")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("p",[t._v("动作参数会被不同的参数填入，如下所示：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("https://hostname/index.php?r=post/view&id=123")]),t._v(": "),s("code",[t._v("$id")]),t._v(" 会填入"),s("code",[t._v("'123'")]),t._v("， "),s("code",[t._v("$version")]),t._v(" 仍为 null 空因为没有"),s("code",[t._v("version")]),t._v("请求参数;")]),t._v(" "),s("li",[s("code",[t._v("https://hostname/index.php?r=post/view&id=123&version=2")]),t._v(": $id"),s("code",[t._v("和")]),t._v("$version"),s("code",[t._v("分别填入")]),t._v("'123'"),s("code",[t._v("和")]),t._v("'2'`；")]),t._v(" "),s("li",[s("code",[t._v("https://hostname/index.php?r=post/view")]),t._v(": 会抛出"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-badrequesthttpexception",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\web\\BadRequestHttpException"),s("OutboundLink")],1),t._v(" 异常 因为请求没有提供参数给必须赋值参数"),s("code",[t._v("$id")]),t._v("；")]),t._v(" "),s("li",[s("code",[t._v("https://hostname/index.php?r=post/view&id[]=123")]),t._v(": 会抛出"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-web-badrequesthttpexception",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\web\\BadRequestHttpException"),s("OutboundLink")],1),t._v(" 异常 因为 "),s("code",[t._v("$id")]),t._v(" 参数收到数组值 "),s("code",[t._v("['123']")]),t._v(" 而不是字符串.")])]),t._v(" "),s("p",[t._v("如果你想要一个动作参数来接受数组值，你应该使用 "),s("code",[t._v("array")]),t._v(" 来提示它，如下所示：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("actionView")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword type-hint"}},[t._v("array")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$version")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("现在如果请求为 "),s("code",[t._v("https://hostname/index.php?r=post/view&id[]=123")]),t._v(", 参数 "),s("code",[t._v("$id")]),t._v(" 会使用数组值 "),s("code",[t._v("['123']")]),t._v("， 如果请求为 "),s("code",[t._v("https://hostname/index.php?r=post/view&id=123")]),t._v("， 参数 "),s("code",[t._v("$id")]),t._v(" 会获取相同数组值，因为无类型的 "),s("code",[t._v("'123'")]),t._v(" 会自动转成数组。")]),t._v(" "),s("p",[t._v("上述例子主要描述网页应用的操作参数，对于控制台应用， 更多详情请参阅"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/tutorial-console",target:"_blank",rel:"noopener noreferrer"}},[t._v("控制台命令"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"默认动作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#默认动作"}},[t._v("#")]),t._v(" 默认动作")]),t._v(" "),s("p",[t._v("每个控制器都有一个由 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-controller#$defaultAction-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Controller::$defaultAction"),s("OutboundLink")],1),t._v(" 属性指定的默认操作， 当"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-controllers#ids-routes",target:"_blank",rel:"noopener noreferrer"}},[t._v("路由"),s("OutboundLink")],1),t._v(" 只包含控制器ID， 会使用所请求的控制器的默认操作。")]),t._v(" "),s("p",[t._v("默认操作默认为 "),s("code",[t._v("index")]),t._v("，如果想修改默认操作，只需简单地在控制器类中覆盖这个属性， 如下所示：")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("controllers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("yii"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("web"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Controller")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("SiteController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Controller")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$defaultAction")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'home'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("actionHome")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'home'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("h2",{attrs:{id:"控制器生命周期"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#控制器生命周期"}},[t._v("#")]),t._v(" 控制器生命周期")]),t._v(" "),s("p",[t._v("处理一个请求时，"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-applications",target:"_blank",rel:"noopener noreferrer"}},[t._v("应用主体"),s("OutboundLink")],1),t._v(" 会根据请求 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-controllers#routes",target:"_blank",rel:"noopener noreferrer"}},[t._v("路由"),s("OutboundLink")],1),t._v("创建一个控制器， 控制器经过以下生命周期来完成请求：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("在控制器创建和配置后，"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-controller#init()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\Controller::init()"),s("OutboundLink")],1),t._v(" 方法会被调用。")])]),t._v(" "),s("li",[s("p",[t._v("控制器根据请求操作ID创建一个操作对象:")]),t._v(" "),s("ul",[s("li",[t._v("如果操作ID没有指定，会使用"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-controller#$defaultAction-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("default action ID"),s("OutboundLink")],1),t._v("默认操作ID；")]),t._v(" "),s("li",[t._v("如果在"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-controller#actions()-detail",target:"_blank",rel:"noopener noreferrer"}},[t._v("action map"),s("OutboundLink")],1),t._v("找到操作ID， 会创建一个独立操作；")]),t._v(" "),s("li",[t._v("如果操作ID对应操作方法，会创建一个内联操作；")]),t._v(" "),s("li",[t._v("否则会抛出"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/api/2.0/yii-base-invalidrouteexception",target:"_blank",rel:"noopener noreferrer"}},[t._v("yii\\base\\InvalidRouteException"),s("OutboundLink")],1),t._v("异常。")])])]),t._v(" "),s("li",[s("p",[t._v("控制器按顺序调用应用主体、模块（如果控制器属于模块）、 控制器的beforeAction()方法；")]),t._v(" "),s("ul",[s("li",[t._v("如果任意一个调用返回false，后面未调用的"),s("code",[t._v("beforeAction()")]),t._v("会跳过并且操作执行会被取消； action execution will be cancelled.")]),t._v(" "),s("li",[t._v("默认情况下每个 "),s("code",[t._v("beforeAction()")]),t._v(" 方法会触发一个 "),s("code",[t._v("beforeAction")]),t._v(" 事件，在事件中你可以追加事件处理操作；")])])]),t._v(" "),s("li",[s("p",[t._v("控制器执行操作:")]),t._v(" "),s("ul",[s("li",[t._v("请求数据解析和填入到操作参数；")])])]),t._v(" "),s("li",[s("p",[t._v("控制器按顺序调用控制器、模块（如果控制器属于模块）、应用主体的afterAction()方法；")]),t._v(" "),s("ul",[s("li",[t._v("默认情况下每个 "),s("code",[t._v("afterAction()")]),t._v(" 方法会触发一个 "),s("code",[t._v("afterAction")]),t._v(" 事件， 在事件中你可以追加事件处理操作；")])])]),t._v(" "),s("li",[s("p",[t._v("应用主体获取操作结果并赋值给"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/runtime-responses",target:"_blank",rel:"noopener noreferrer"}},[t._v("响应"),s("OutboundLink")],1),t._v(".")])])]),t._v(" "),s("h2",{attrs:{id:"最佳实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),s("p",[t._v("在设计良好的应用中，控制器很精练，包含的操作代码简短； 如果你的控制器很复杂，通常意味着需要重构， 转移一些代码到其他类中。")]),t._v(" "),s("p",[t._v("归纳起来，控制器")]),t._v(" "),s("ul",[s("li",[t._v("可访问 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/runtime-requests",target:"_blank",rel:"noopener noreferrer"}},[t._v("请求"),s("OutboundLink")],1),t._v(" 数据;")]),t._v(" "),s("li",[t._v("可根据请求数据调用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-models",target:"_blank",rel:"noopener noreferrer"}},[t._v("模型"),s("OutboundLink")],1),t._v(" 的方法和其他服务组件;")]),t._v(" "),s("li",[t._v("可使用 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views",target:"_blank",rel:"noopener noreferrer"}},[t._v("视图"),s("OutboundLink")],1),t._v(" 构造响应;")]),t._v(" "),s("li",[t._v("不应处理应被"),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-models",target:"_blank",rel:"noopener noreferrer"}},[t._v("模型"),s("OutboundLink")],1),t._v("处理的请求数据;")]),t._v(" "),s("li",[t._v("应避免嵌入HTML或其他展示代码，这些代码最好在 "),s("a",{attrs:{href:"https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views",target:"_blank",rel:"noopener noreferrer"}},[t._v("视图"),s("OutboundLink")],1),t._v("中处理.")])])])}),[],!1,null,null,null);s.default=e.exports}}]);