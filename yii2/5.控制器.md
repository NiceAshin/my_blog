---
title: æ§åˆ¶å™?
date: 2026-02-27
tags:
  - Yii2
  - PHP
categories:
  - PHPæ¡†æ¶æ¢ç´¢
prev: 4.åº”ç”¨ç»„ä»¶
next: 6.æ¨¡å‹
---

# æ§åˆ¶å™?

æ§åˆ¶å™¨æ˜¯ [MVC](https://zh.wikipedia.org/wiki/MVC) æ¨¡å¼ä¸­çš„ä¸€éƒ¨åˆ†ï¼?æ˜¯ç»§æ‰¿[yii\base\Controller](https://www.yiiframework.com/doc/api/2.0/yii-base-controller)ç±»çš„å¯¹è±¡ï¼Œè´Ÿè´£å¤„ç†è¯·æ±‚å’Œç”Ÿæˆå“åº”ã€?å…·ä½“æ¥è¯´ï¼Œæ§åˆ¶å™¨ä»[åº”ç”¨ä¸»ä½“](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-applications) æ¥ç®¡æ§åˆ¶åä¼šåˆ†æè¯·æ±‚æ•°æ®å¹¶ä¼ é€åˆ°[æ¨¡å‹](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-models)ï¼?ä¼ é€æ¨¡å‹ç»“æœåˆ°[è§†å›¾](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views)ï¼Œæœ€åç”Ÿæˆè¾“å‡ºå“åº”ä¿¡æ¯ã€?

## åŠ¨ä½œ

æ§åˆ¶å™¨ç”± *æ“ä½œ* ç»„æˆï¼Œå®ƒæ˜¯æ‰§è¡Œç»ˆç«¯ç”¨æˆ·è¯·æ±‚çš„æœ€åŸºç¡€çš„å•å…ƒï¼Œ ä¸€ä¸ªæ§åˆ¶å™¨å¯æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œã€?

å¦‚ä¸‹ç¤ºä¾‹æ˜¾ç¤ºåŒ…å«ä¸¤ä¸ªåŠ¨ä½œ`view` and `create` çš„æ§åˆ¶å™¨`post`ï¼?

```php
namespace app\controllers;

use Yii;
use app\models\Post;
use yii\web\Controller;
use yii\web\NotFoundHttpException;

class PostController extends Controller
{
    public function actionView($id)
    {
        $model = Post::findOne($id);
        if ($model === null) {
            throw new NotFoundHttpException;
        }

        return $this->render('view', [
            'model' => $model,
        ]);
    }

    public function actionCreate()
    {
        $model = new Post;

        if ($model->load(Yii::$app->request->post()) && $model->save()) {
            return $this->redirect(['view', 'id' => $model->id]);
        } else {
            return $this->render('create', [
                'model' => $model,
            ]);
        }
    }
}
```

åœ¨æ“ä½?`view` (å®šä¹‰ä¸?`actionView()` æ–¹æ³•)ä¸­ï¼Œ ä»£ç é¦–å…ˆæ ¹æ®è¯·æ±‚æ¨¡å‹IDåŠ è½½ [æ¨¡å‹](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-models)ï¼?å¦‚æœåŠ è½½æˆåŠŸï¼Œä¼šæ¸²æŸ“åç§°ä¸º`view`çš„[è§†å›¾](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views)å¹¶æ˜¾ç¤ºï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€?

åœ¨æ“ä½?`create` (å®šä¹‰ä¸?`actionCreate()` æ–¹æ³•)ä¸? ä»£ç ç›¸ä¼¼. å…ˆå°†è¯·æ±‚æ•°æ®å¡«å…¥[æ¨¡å‹](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-models)ï¼?ç„¶åä¿å­˜æ¨¡å‹ï¼Œå¦‚æœä¸¤è€…éƒ½æˆåŠŸï¼Œä¼šè·³è½¬åˆ°IDä¸ºæ–°åˆ›å»ºçš„æ¨¡å‹çš„`view`æ“ä½œï¼?å¦åˆ™æ˜¾ç¤ºæä¾›ç”¨æˆ·è¾“å…¥çš„`create`è§†å›¾ã€?

## è·¯ç”±

ç»ˆç«¯ç”¨æˆ·é€šè¿‡æ‰€è°“çš„*è·¯ç”±*å¯»æ‰¾åˆ°åŠ¨ä½œï¼Œè·¯ç”±æ˜¯åŒ…å«ä»¥ä¸‹éƒ¨åˆ†çš„å­—ç¬¦ä¸²ï¼š

- æ¨¡å—ID: ä»…å­˜åœ¨äºæ§åˆ¶å™¨å±äºéåº”ç”¨çš„[æ¨¡å—](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-modules);
- æ§åˆ¶å™¨ID: åŒåº”ç”¨ï¼ˆæˆ–åŒæ¨¡å—å¦‚æœä¸ºæ¨¡å—ä¸‹çš„æ§åˆ¶å™¨ï¼?ä¸‹å”¯ä¸€æ ‡è¯†æ§åˆ¶å™¨çš„å­—ç¬¦ä¸?
- æ“ä½œID: åŒæ§åˆ¶å™¨ä¸‹å”¯ä¸€æ ‡è¯†æ“ä½œçš„å­—ç¬¦ä¸²ã€?

è·¯ç”±ä½¿ç”¨å¦‚ä¸‹æ ¼å¼:

```
ControllerID/ActionID
```

å¦‚æœå±äºæ¨¡å—ä¸‹çš„æ§åˆ¶å™¨ï¼Œä½¿ç”¨å¦‚ä¸‹æ ¼å¼ï¼?

```php
ModuleID/ControllerID/ActionID
```

å¦‚æœç”¨æˆ·çš„è¯·æ±‚åœ°å€ä¸?`https://hostname/index.php?r=site/index`, ä¼šæ‰§è¡Œ`site` æ§åˆ¶å™¨çš„`index` æ“ä½œã€?æ›´å¤šå…³äºå¤„ç†è·¯ç”±çš„è¯¦æƒ…è¯·å‚é˜… [è·¯ç”±](https://www.yiiframework.com/doc/guide/2.0/zh-cn/runtime-routing) ä¸€èŠ‚ã€?

## åˆ›å»ºæ§åˆ¶å™?

åœ¨[Web applications](https://www.yiiframework.com/doc/api/2.0/yii-web-application)ç½‘é¡µåº”ç”¨ä¸­ï¼Œæ§åˆ¶å™¨åº”ç»§æ‰¿[yii\web\Controller](https://www.yiiframework.com/doc/api/2.0/yii-web-controller) æˆ–å®ƒçš„å­ç±»ã€?åŒç†åœ¨[console applications](https://www.yiiframework.com/doc/api/2.0/yii-console-application)æ§åˆ¶å°åº”ç”¨ä¸­ï¼Œæ§åˆ¶å™¨ç»§æ‰¿[yii\console\Controller](https://www.yiiframework.com/doc/api/2.0/yii-console-controller) æˆ–å®ƒçš„å­ç±»ã€?å¦‚ä¸‹ä»£ç å®šä¹‰ä¸€ä¸?`site` æ§åˆ¶å™?

```php
namespace app\controllers;

use yii\web\Controller;

class SiteController extends Controller
{
}
```

### æ§åˆ¶å™¨ID

é€šå¸¸æƒ…å†µä¸‹ï¼Œæ§åˆ¶å™¨ç”¨æ¥å¤„ç†è¯·æ±‚æœ‰å…³çš„èµ„æºç±»å‹ï¼?å› æ­¤æ§åˆ¶å™¨IDé€šå¸¸ä¸ºå’Œèµ„æºæœ‰å…³çš„åè¯ã€?ä¾‹å¦‚ä½¿ç”¨`article`ä½œä¸ºå¤„ç†æ–‡ç« çš„æ§åˆ¶å™¨IDã€?

æ§åˆ¶å™¨IDåº”ä»…åŒ…å«è‹±æ–‡å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€ä¸­æ¨ªæ å’Œæ­£æ–œæ ï¼?ä¾‹å¦‚ `article` å’?`post-comment` æ˜¯çœŸæ˜¯çš„æ§åˆ¶å™¨IDï¼?`article?`, `PostComment`, `admin\post`ä¸æ˜¯æ§åˆ¶å™¨IDã€?

æ§åˆ¶å™¨Idå¯åŒ…å«å­ç›®å½•å‰ç¼€ï¼Œä¾‹å¦?`admin/article` ä»£è¡¨ [controller namespace](https://www.yiiframework.com/doc/api/2.0/yii-base-application#$controllerNamespace-detail) æ§åˆ¶å™¨å‘½åç©ºé—´ä¸‹ `admin`å­ç›®å½•ä¸­ `article` æ§åˆ¶å™¨ã€?å­ç›®å½•å‰ç¼€å¯ä¸ºè‹±æ–‡å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€æ­£æ–œæ ï¼Œå…¶ä¸­æ­£æ–œæ ç”¨æ¥åŒºåˆ†å¤šçº§å­ç›®å½?å¦?`panels/admin`)ã€?

### æ§åˆ¶å™¨ç±»å‘½å

æ§åˆ¶å™¨IDéµå¾ªä»¥ä¸‹è§„åˆ™è¡ç”Ÿæ§åˆ¶å™¨ç±»åï¼š

1. å°†ç”¨æ­£æ–œæ åŒºåˆ†çš„æ¯ä¸ªå•è¯ç¬¬ä¸€ä¸ªå­—æ¯è½¬ä¸ºå¤§å†™ã€‚æ³¨æ„å¦‚æœæ§åˆ¶å™¨IDåŒ…å«æ­£æ–œæ ï¼Œ åªå°†æœ€åçš„æ­£æ–œæ åçš„éƒ¨åˆ†ç¬¬ä¸€ä¸ªå­—æ¯è½¬ä¸ºå¤§å†™ï¼›
2. å»æ‰ä¸­æ¨ªæ ï¼Œå°†æ­£æ–œæ æ›¿æ¢ä¸ºåæ–œæ ;
3. å¢åŠ `Controller`åç¼€;
4. åœ¨å‰é¢å¢åŠ [controller namespace](https://www.yiiframework.com/doc/api/2.0/yii-base-application#$controllerNamespace-detail)æ§åˆ¶å™¨å‘½åç©ºé—?

ä¸‹é¢ä¸ºä¸€äº›ç¤ºä¾‹ï¼Œå‡è®¾[controller namespace](https://www.yiiframework.com/doc/api/2.0/yii-base-application#$controllerNamespace-detail) æ§åˆ¶å™¨å‘½åç©ºé—´ä¸º `app\controllers`:

- `article` å¯¹åº” `app\controllers\ArticleController`;
- `post-comment` å¯¹åº” `app\controllers\PostCommentController`;
- `admin/post-comment` å¯¹åº” `app\controllers\admin\PostCommentController`;
- `adminPanels/post-comment` å¯¹åº” `app\controllers\adminPanels\PostCommentController`.

æ§åˆ¶å™¨ç±»å¿…é¡»èƒ½è¢« [è‡ªåŠ¨åŠ è½½](https://www.yiiframework.com/doc/guide/2.0/zh-cn/concept-autoloading)ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼?æ§åˆ¶å™¨`article` ç±»åº”åœ?[åˆ«å](https://www.yiiframework.com/doc/guide/2.0/zh-cn/concept-aliases) ä¸º`@app/controllers/ArticleController.php`çš„æ–‡ä»¶ä¸­å®šä¹‰ï¼?æ§åˆ¶å™¨`admin/post-comment`åº”åœ¨`@app/controllers/admin/PostCommentController.php`æ–‡ä»¶ä¸­ã€?

> **ä¿¡æ¯ï¼?* æœ€åä¸€ä¸ªç¤ºä¾?`admin/post-comment` è¡¨ç¤ºä½ å¯ä»¥å°†æ§åˆ¶å™¨æ”¾åœ?[controller namespace](https://www.yiiframework.com/doc/api/2.0/yii-base-application#$controllerNamespace-detail)æ§åˆ¶å™¨å‘½åç©ºé—´ä¸‹çš„å­ç›®å½•ä¸­ï¼Œ åœ¨ä½ ä¸æƒ³ç”?[æ¨¡å—](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-modules) çš„æƒ…å†µä¸‹ç»™æ§åˆ¶å™¨åˆ†ç±»ï¼Œè¿™ç§æ–¹å¼å¾ˆæœ‰ç”¨ã€?

### æ§åˆ¶å™¨éƒ¨ç½?

å¯é€šè¿‡é…ç½® [controller map](https://www.yiiframework.com/doc/api/2.0/yii-base-module#$controllerMap-detail) æ¥å¼ºåˆ¶ä¸Šè¿°çš„æ§åˆ¶å™¨IDå’Œç±»åå¯¹åº”ï¼Œ é€šå¸¸ç”¨åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸èƒ½æŒæ§ç±»åçš„æ§åˆ¶å™¨ä¸Šã€?

é…ç½® [åº”ç”¨é…ç½®](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-applications#application-configurations) ä¸­çš„[application configuration](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-applications#application-configurations)ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```php
[
    'controllerMap' => [
        // ç”¨ç±»åç”³æ˜?"account" æ§åˆ¶å™?
        'account' => 'app\controllers\UserController',

        // ç”¨é…ç½®æ•°ç»„ç”³æ˜?"article" æ§åˆ¶å™?
        'article' => [
            'class' => 'app\controllers\PostController',
            'enableCsrfValidation' => false,
        ],
    ],
]
```

### é»˜è®¤æ§åˆ¶å™?

æ¯ä¸ªåº”ç”¨æœ‰ä¸€ä¸ªç”±[yii\base\Application::$defaultRoute](https://www.yiiframework.com/doc/api/2.0/yii-base-module#$defaultRoute-detail)å±æ€§æŒ‡å®šçš„é»˜è®¤æ§åˆ¶å™¨ï¼› å½“è¯·æ±‚æ²¡æœ‰æŒ‡å®?[è·¯ç”±](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-controllers#ids-routes)ï¼Œè¯¥å±æ€§å€¼ä½œä¸ºè·¯ç”±ä½¿ç”¨ã€?å¯¹äº[Web applications](https://www.yiiframework.com/doc/api/2.0/yii-web-application)ç½‘é¡µåº”ç”¨ï¼Œå®ƒçš„å€¼ä¸º `'site'`ï¼Œå¯¹äº?[console applications](https://www.yiiframework.com/doc/api/2.0/yii-console-application) æ§åˆ¶å°åº”ç”¨ï¼Œå®ƒçš„å€¼ä¸º `help`ï¼Œæ‰€ä»¥URLä¸?`https://hostname/index.php` è¡¨ç¤ºç”?`site` æ§åˆ¶å™¨æ¥å¤„ç†ã€?

å¯ä»¥åœ?[åº”ç”¨é…ç½®](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-applications#application-configurations) ä¸­ä¿®æ”¹é»˜è®¤æ§åˆ¶å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```php
[
    'defaultRoute' => 'main',
]
```

## åˆ›å»ºåŠ¨ä½œ

åˆ›å»ºæ“ä½œå¯ç®€å•åœ°åœ¨æ§åˆ¶å™¨ç±»ä¸­å®šä¹‰æ‰€è°“çš„ *æ“ä½œæ–¹æ³•* æ¥å®Œæˆï¼Œæ“ä½œæ–¹æ³•å¿…é¡»æ˜¯ä»¥`action`å¼€å¤´çš„å…¬æœ‰æ–¹æ³•ã€?æ“ä½œæ–¹æ³•çš„è¿”å›å€¼ä¼šä½œä¸ºå“åº”æ•°æ®å‘é€ç»™ç»ˆç«¯ç”¨æˆ·ï¼?å¦‚ä¸‹ä»£ç å®šä¹‰äº†ä¸¤ä¸ªæ“ä½?`index` å’?`hello-world`:

```php
namespace app\controllers;

use yii\web\Controller;

class SiteController extends Controller
{
    public function actionIndex()
    {
        return $this->render('index');
    }

    public function actionHelloWorld()
    {
        return 'Hello World';
    }
}
```

### åŠ¨ä½œID

æ“ä½œé€šå¸¸æ˜¯ç”¨æ¥æ‰§è¡Œèµ„æºçš„ç‰¹å®šæ“ä½œï¼Œå› æ­¤ï¼Œ æ“ä½œIDé€šå¸¸ä¸ºåŠ¨è¯ï¼Œå¦‚`view`, `update`ç­‰ã€?

æ“ä½œIDåº”ä»…åŒ…å«è‹±æ–‡å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œä¸­æ¨ªæ ï¼Œæ“ä½œIDä¸­çš„ä¸­æ¨ªæ ç”¨æ¥åˆ†éš”å•è¯ã€?ä¾‹å¦‚`view`, `update2`, `comment-post`æ˜¯çœŸå®çš„æ“ä½œIDï¼?`view?`, `Update`ä¸æ˜¯æ“ä½œID.

å¯é€šè¿‡ä¸¤ç§æ–¹å¼åˆ›å»ºæ“ä½œIDï¼Œå†…è”æ“ä½œå’Œç‹¬ç«‹æ“ä½œ. An inline action is å†…è”æ“ä½œåœ¨æ§åˆ¶å™¨ç±»ä¸­å®šä¹‰ä¸ºæ–¹æ³•ï¼›ç‹¬ç«‹æ“ä½œæ˜¯ç»§æ‰¿[yii\base\Action](https://www.yiiframework.com/doc/api/2.0/yii-base-action)æˆ–å®ƒçš„å­ç±»çš„ç±»ã€?å†…è”æ“ä½œå®¹æ˜“åˆ›å»ºï¼Œåœ¨æ— éœ€é‡ç”¨çš„æƒ…å†µä¸‹ä¼˜å…ˆä½¿ç”¨ï¼?ç‹¬ç«‹æ“ä½œç›¸åï¼Œä¸»è¦ç”¨äºå¤šä¸ªæ§åˆ¶å™¨é‡ç”¨ï¼?æˆ–é‡æ„ä¸º[æ‰©å±•](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-extensions)ã€?

### å†…è”åŠ¨ä½œ

å†…è”åŠ¨ä½œæŒ‡çš„æ˜¯æ ¹æ®æˆ‘ä»¬åˆšæè¿°çš„æ“ä½œæ–¹æ³•ã€?

åŠ¨ä½œæ–¹æ³•çš„åå­—æ˜¯æ ¹æ®æ“ä½œIDéµå¾ªå¦‚ä¸‹è§„åˆ™è¡ç”Ÿï¼?

1. å°†æ¯ä¸ªå•è¯çš„ç¬¬ä¸€ä¸ªå­—æ¯è½¬ä¸ºå¤§å†?
2. å»æ‰ä¸­æ¨ªæ?
3. å¢åŠ `action`å‰ç¼€.

ä¾‹å¦‚`index` è½¬æˆ `actionIndex`, `hello-world` è½¬æˆ `actionHelloWorld`ã€?

> **æ³¨æ„ï¼?* æ“ä½œæ–¹æ³•çš„åå­?å¤§å°å†™æ•æ„?ï¼Œå¦‚æœæ–¹æ³•åç§°ä¸º`ActionIndex`ä¸ä¼šè®¤ä¸ºæ˜¯æ“ä½œæ–¹æ³•ï¼Œ æ‰€ä»¥è¯·æ±‚`index`æ“ä½œä¼šè¿”å›ä¸€ä¸ªå¼‚å¸¸ï¼Œ ä¹Ÿè¦æ³¨æ„æ“ä½œæ–¹æ³•å¿…é¡»æ˜¯å…¬æœ‰çš„ï¼?ç§æœ‰æˆ–è€…å—ä¿æŠ¤çš„æ–¹æ³•ä¸èƒ½å®šä¹‰æˆå†…è”æ“ä½œã€?

å› ä¸ºå®¹æ˜“åˆ›å»ºï¼Œå†…è”æ“ä½œæ˜¯æœ€å¸¸ç”¨çš„æ“ä½œï¼Œ ä½†æ˜¯å¦‚æœä½ è®¡åˆ’åœ¨ä¸åŒåœ°æ–¹é‡ç”¨ç›¸åŒçš„æ“ä½œï¼Œ æˆ–è€…ä½ æƒ³é‡æ–°åˆ†é…ä¸€ä¸ªæ“ä½œï¼Œéœ€è¦è€ƒè™‘å®šä¹‰å®ƒä¸º*ç‹¬ç«‹æ“ä½œ*ã€?

### ç‹¬ç«‹åŠ¨ä½œ

ç‹¬ç«‹æ“ä½œé€šè¿‡ç»§æ‰¿[yii\base\Action](https://www.yiiframework.com/doc/api/2.0/yii-base-action)æˆ–å®ƒçš„å­ç±»æ¥å®šä¹‰ã€?ä¾‹å¦‚Yiiå‘å¸ƒçš„[yii\web\ViewAction](https://www.yiiframework.com/doc/api/2.0/yii-web-viewaction) å’Œ[yii\web\ErrorAction](https://www.yiiframework.com/doc/api/2.0/yii-web-erroraction)éƒ½æ˜¯ç‹¬ç«‹æ“ä½œã€?

è¦ä½¿ç”¨ç‹¬ç«‹æ“ä½œï¼Œéœ€è¦é€šè¿‡æ§åˆ¶å™¨ä¸­è¦†ç›–[yii\base\Controller::actions()](https://www.yiiframework.com/doc/api/2.0/yii-base-controller#actions()-detail)æ–¹æ³•åœ?action map*ä¸­ç”³æ˜ï¼Œ å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š

```php
public function actions()
{
    return [
        // ç”¨ç±»æ¥ç”³æ˜?error" åŠ¨ä½œ
        'error' => 'yii\web\ErrorAction',

        // ç”¨é…ç½®æ•°ç»„ç”³æ˜?"view" åŠ¨ä½œ
        'view' => [
            'class' => 'yii\web\ViewAction',
            'viewPrefix' => '',
        ],
    ];
}
```

å¦‚ä¸Šæ‰€ç¤ºï¼Œ `actions()` æ–¹æ³•è¿”å›é”®ä¸ºæ“ä½œIDã€å€¼ä¸ºå¯¹åº”æ“ä½œç±»å æˆ–æ•°ç»„[configurations](https://www.yiiframework.com/doc/guide/2.0/zh-cn/concept-configurations) çš„æ•°ç»„ã€?å’Œå†…è”æ“ä½œä¸åŒï¼Œç‹¬ç«‹æ“ä½œIDå¯åŒ…å«ä»»æ„å­—ç¬¦ï¼Œåªè¦åœ¨`actions()` æ–¹æ³•ä¸­ç”³æ˜?

ä¸ºåˆ›å»ºä¸€ä¸ªç‹¬ç«‹æ“ä½œç±»ï¼Œéœ€è¦ç»§æ‰¿[yii\base\Action](https://www.yiiframework.com/doc/api/2.0/yii-base-action) æˆ–å®ƒçš„å­ç±»ï¼Œå¹¶å®ç°å…¬æœ‰çš„åç§°ä¸º`run()`çš„æ–¹æ³? `run()` æ–¹æ³•çš„è§’è‰²å’Œæ“ä½œæ–¹æ³•ç±»ä¼¼ï¼Œä¾‹å¦‚ï¼š

```php
<?php
namespace app\components;

use yii\base\Action;

class HelloWorldAction extends Action
{
    public function run()
    {
        return "Hello World";
    }
}
```

### åŠ¨ä½œç»“æœ

æ“ä½œæ–¹æ³•æˆ–ç‹¬ç«‹æ“ä½œçš„`run()`æ–¹æ³•çš„è¿”å›å€¼éå¸¸é‡è¦ï¼Œ å®ƒè¡¨ç¤ºå¯¹åº”æ“ä½œç»“æœã€?

è¿”å›å€¼å¯ä¸?[å“åº”](https://www.yiiframework.com/doc/guide/2.0/zh-cn/runtime-responses) å¯¹è±¡ï¼Œä½œä¸ºå“åº”å‘é€ç»™ç»ˆç«¯ç”¨æˆ·ã€?

- å¯¹äº[Web applications](https://www.yiiframework.com/doc/api/2.0/yii-web-application)ç½‘é¡µåº”ç”¨ï¼Œè¿”å›å€¼å¯ä¸ºä»»æ„æ•°æ? å®ƒèµ‹å€¼ç»™[yii\web\Response::$data](https://www.yiiframework.com/doc/api/2.0/yii-web-response#$data-detail)ï¼?æœ€ç»ˆè½¬æ¢ä¸ºå­—ç¬¦ä¸²æ¥å±•ç¤ºå“åº”å†…å®¹ã€?
- å¯¹äº[console applications](https://www.yiiframework.com/doc/api/2.0/yii-console-application)æ§åˆ¶å°åº”ç”¨ï¼Œè¿”å›å€¼å¯ä¸ºæ•´æ•°ï¼Œ è¡¨ç¤ºå‘½ä»¤è¡Œä¸‹æ‰§è¡Œçš?[exit status](https://www.yiiframework.com/doc/api/2.0/yii-base-response#$exitStatus-detail) é€€å‡ºçŠ¶æ€ã€?

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ“ä½œç»“æœéƒ½ä¸ºå­—ç¬¦ä¸²ï¼Œä½œä¸ºå“åº”æ•°æ®å‘é€ç»™ç»ˆç«¯ç”¨æˆ·ï¼?ä¸‹ä¾‹æ˜¾ç¤ºä¸€ä¸ªæ“ä½œé€šè¿‡ è¿”å›å“åº”å¯¹è±¡ï¼ˆå› ä¸º[redirect()](https://www.yiiframework.com/doc/api/2.0/yii-web-controller#redirect()-detail)æ–¹æ³•è¿”å›ä¸€ä¸ªå“åº”å¯¹è±¡ï¼‰ å¯å°†ç”¨æˆ·æµè§ˆå™¨è·³è½¬åˆ°æ–°çš„URLã€?

```php
public function actionForward()
{
    // ç”¨æˆ·æµè§ˆå™¨è·³è½¬åˆ° https://example.com
    return $this->redirect('https://example.com');
}
```

### åŠ¨ä½œå‚æ•°

å†…è”åŠ¨ä½œçš„æ“ä½œæ–¹æ³•å’Œç‹¬ç«‹åŠ¨ä½œçš?`run()` æ–¹æ³•å¯ä»¥å¸¦å‚æ•°ï¼Œç§°ä¸º*åŠ¨ä½œå‚æ•°*ã€?å‚æ•°å€¼ä»è¯·æ±‚ä¸­è·å–ï¼Œå¯¹äº[Web applications](https://www.yiiframework.com/doc/api/2.0/yii-web-application)ç½‘é¡µåº”ç”¨ï¼?æ¯ä¸ªåŠ¨ä½œå‚æ•°çš„å€¼ä»`$_GET`ä¸­è·å¾—ï¼Œå‚æ•°åä½œä¸ºé”®ï¼?å¯¹äº[console applications](https://www.yiiframework.com/doc/api/2.0/yii-console-application)æ§åˆ¶å°åº”ç”? åŠ¨ä½œå‚æ•°å¯¹åº”å‘½ä»¤è¡Œå‚æ•°ã€?

å¦‚ä¸‹ä¾‹ï¼ŒåŠ¨ä½œ`view` (å†…è”åŠ¨ä½œ) ç”³æ˜äº†ä¸¤ä¸ªå‚æ•?`$id` å’?`$version`ã€?

```php
namespace app\controllers;

use yii\web\Controller;

class PostController extends Controller
{
    public function actionView($id, $version = null)
    {
        // ...
    }
}
```

åŠ¨ä½œå‚æ•°ä¼šè¢«ä¸åŒçš„å‚æ•°å¡«å…¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

- `https://hostname/index.php?r=post/view&id=123`: `$id` ä¼šå¡«å…¥`'123'`ï¼?`$version` ä»ä¸º null ç©ºå› ä¸ºæ²¡æœ‰`version`è¯·æ±‚å‚æ•°;
- `https://hostname/index.php?r=post/view&id=123&version=2`: $id` å’?`$version` åˆ†åˆ«å¡«å…¥ `'123'` å’?`'2'`ï¼?
- `https://hostname/index.php?r=post/view`: ä¼šæŠ›å‡º[yii\web\BadRequestHttpException](https://www.yiiframework.com/doc/api/2.0/yii-web-badrequesthttpexception) å¼‚å¸¸ å› ä¸ºè¯·æ±‚æ²¡æœ‰æä¾›å‚æ•°ç»™å¿…é¡»èµ‹å€¼å‚æ•°`$id`ï¼?
- `https://hostname/index.php?r=post/view&id[]=123`: ä¼šæŠ›å‡º[yii\web\BadRequestHttpException](https://www.yiiframework.com/doc/api/2.0/yii-web-badrequesthttpexception) å¼‚å¸¸ å› ä¸º `$id` å‚æ•°æ”¶åˆ°æ•°ç»„å€?`['123']` è€Œä¸æ˜¯å­—ç¬¦ä¸².

å¦‚æœä½ æƒ³è¦ä¸€ä¸ªåŠ¨ä½œå‚æ•°æ¥æ¥å—æ•°ç»„å€¼ï¼Œä½ åº”è¯¥ä½¿ç”?`array` æ¥æç¤ºå®ƒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```php
public function actionView(array $id, $version = null)
{
    // ...
}
```

ç°åœ¨å¦‚æœè¯·æ±‚ä¸?`https://hostname/index.php?r=post/view&id[]=123`, å‚æ•° `$id` ä¼šä½¿ç”¨æ•°ç»„å€?`['123']`ï¼?å¦‚æœè¯·æ±‚ä¸?`https://hostname/index.php?r=post/view&id=123`ï¼?å‚æ•° `$id` ä¼šè·å–ç›¸åŒæ•°ç»„å€¼ï¼Œå› ä¸ºæ— ç±»å‹çš„ `'123'` ä¼šè‡ªåŠ¨è½¬æˆæ•°ç»„ã€?

ä¸Šè¿°ä¾‹å­ä¸»è¦æè¿°ç½‘é¡µåº”ç”¨çš„æ“ä½œå‚æ•°ï¼Œå¯¹äºæ§åˆ¶å°åº”ç”¨ï¼Œ æ›´å¤šè¯¦æƒ…è¯·å‚é˜…[æ§åˆ¶å°å‘½ä»¤](https://www.yiiframework.com/doc/guide/2.0/zh-cn/tutorial-console)ã€?

### é»˜è®¤åŠ¨ä½œ

æ¯ä¸ªæ§åˆ¶å™¨éƒ½æœ‰ä¸€ä¸ªç”± [yii\base\Controller::$defaultAction](https://www.yiiframework.com/doc/api/2.0/yii-base-controller#$defaultAction-detail) å±æ€§æŒ‡å®šçš„é»˜è®¤æ“ä½œï¼?å½“[è·¯ç”±](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-controllers#ids-routes) åªåŒ…å«æ§åˆ¶å™¨IDï¼?ä¼šä½¿ç”¨æ‰€è¯·æ±‚çš„æ§åˆ¶å™¨çš„é»˜è®¤æ“ä½œã€?

é»˜è®¤æ“ä½œé»˜è®¤ä¸?`index`ï¼Œå¦‚æœæƒ³ä¿®æ”¹é»˜è®¤æ“ä½œï¼Œåªéœ€ç®€å•åœ°åœ¨æ§åˆ¶å™¨ç±»ä¸­è¦†ç›–è¿™ä¸ªå±æ€§ï¼Œ å¦‚ä¸‹æ‰€ç¤ºï¼š

```php
namespace app\controllers;

use yii\web\Controller;

class SiteController extends Controller
{
    public $defaultAction = 'home';

    public function actionHome()
    {
        return $this->render('home');
    }
}
```

## æ§åˆ¶å™¨ç”Ÿå‘½å‘¨æœ?

å¤„ç†ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œ[åº”ç”¨ä¸»ä½“](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-applications) ä¼šæ ¹æ®è¯·æ±?[è·¯ç”±](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-controllers#routes)åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨ï¼?æ§åˆ¶å™¨ç»è¿‡ä»¥ä¸‹ç”Ÿå‘½å‘¨æœŸæ¥å®Œæˆè¯·æ±‚ï¼?

1. åœ¨æ§åˆ¶å™¨åˆ›å»ºå’Œé…ç½®åï¼Œ[yii\base\Controller::init()](https://www.yiiframework.com/doc/api/2.0/yii-base-controller#init()-detail) æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€?

2. æ§åˆ¶å™¨æ ¹æ®è¯·æ±‚æ“ä½œIDåˆ›å»ºä¸€ä¸ªæ“ä½œå¯¹è±?

   - å¦‚æœæ“ä½œIDæ²¡æœ‰æŒ‡å®šï¼Œä¼šä½¿ç”¨[default action ID](https://www.yiiframework.com/doc/api/2.0/yii-base-controller#$defaultAction-detail)é»˜è®¤æ“ä½œIDï¼?
   - å¦‚æœåœ¨[action map](https://www.yiiframework.com/doc/api/2.0/yii-base-controller#actions()-detail)æ‰¾åˆ°æ“ä½œIDï¼?ä¼šåˆ›å»ºä¸€ä¸ªç‹¬ç«‹æ“ä½œï¼›
   - å¦‚æœæ“ä½œIDå¯¹åº”æ“ä½œæ–¹æ³•ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå†…è”æ“ä½œï¼›
   - å¦åˆ™ä¼šæŠ›å‡º[yii\base\InvalidRouteException](https://www.yiiframework.com/doc/api/2.0/yii-base-invalidrouteexception)å¼‚å¸¸ã€?

3. æ§åˆ¶å™¨æŒ‰é¡ºåºè°ƒç”¨åº”ç”¨ä¸»ä½“ã€æ¨¡å—ï¼ˆå¦‚æœæ§åˆ¶å™¨å±äºæ¨¡å—ï¼‰ã€?æ§åˆ¶å™¨çš„beforeAction()æ–¹æ³•ï¼?

   - å¦‚æœä»»æ„ä¸€ä¸ªè°ƒç”¨è¿”å›falseï¼Œåé¢æœªè°ƒç”¨çš„`beforeAction()`ä¼šè·³è¿‡å¹¶ä¸”æ“ä½œæ‰§è¡Œä¼šè¢«å–æ¶ˆï¼› action execution will be cancelled.
   - é»˜è®¤æƒ…å†µä¸‹æ¯ä¸?`beforeAction()` æ–¹æ³•ä¼šè§¦å‘ä¸€ä¸?`beforeAction` äº‹ä»¶ï¼Œåœ¨äº‹ä»¶ä¸­ä½ å¯ä»¥è¿½åŠ äº‹ä»¶å¤„ç†æ“ä½œï¼?
   
4. æ§åˆ¶å™¨æ‰§è¡Œæ“ä½?

   - è¯·æ±‚æ•°æ®è§£æå’Œå¡«å…¥åˆ°æ“ä½œå‚æ•°ï¼?

5. æ§åˆ¶å™¨æŒ‰é¡ºåºè°ƒç”¨æ§åˆ¶å™¨ã€æ¨¡å—ï¼ˆå¦‚æœæ§åˆ¶å™¨å±äºæ¨¡å—ï¼‰ã€åº”ç”¨ä¸»ä½“çš„afterAction()æ–¹æ³•ï¼?

   - é»˜è®¤æƒ…å†µä¸‹æ¯ä¸?`afterAction()` æ–¹æ³•ä¼šè§¦å‘ä¸€ä¸?`afterAction` äº‹ä»¶ï¼?åœ¨äº‹ä»¶ä¸­ä½ å¯ä»¥è¿½åŠ äº‹ä»¶å¤„ç†æ“ä½œï¼›

6. åº”ç”¨ä¸»ä½“è·å–æ“ä½œç»“æœå¹¶èµ‹å€¼ç»™[å“åº”](https://www.yiiframework.com/doc/guide/2.0/zh-cn/runtime-responses).

## æœ€ä½³å®è·?

åœ¨è®¾è®¡è‰¯å¥½çš„åº”ç”¨ä¸­ï¼Œæ§åˆ¶å™¨å¾ˆç²¾ç»ƒï¼ŒåŒ…å«çš„æ“ä½œä»£ç ç®€çŸ­ï¼› å¦‚æœä½ çš„æ§åˆ¶å™¨å¾ˆå¤æ‚ï¼Œé€šå¸¸æ„å‘³ç€éœ€è¦é‡æ„ï¼Œ è½¬ç§»ä¸€äº›ä»£ç åˆ°å…¶ä»–ç±»ä¸­ã€?

å½’çº³èµ·æ¥ï¼Œæ§åˆ¶å™¨

- å¯è®¿é—?[è¯·æ±‚](https://www.yiiframework.com/doc/guide/2.0/zh-cn/runtime-requests) æ•°æ®;
- å¯æ ¹æ®è¯·æ±‚æ•°æ®è°ƒç”?[æ¨¡å‹](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-models) çš„æ–¹æ³•å’Œå…¶ä»–æœåŠ¡ç»„ä»¶;
- å¯ä½¿ç”?[è§†å›¾](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views) æ„é€ å“åº?
- ä¸åº”å¤„ç†åº”è¢«[æ¨¡å‹](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-models)å¤„ç†çš„è¯·æ±‚æ•°æ?
- åº”é¿å…åµŒå…¥HTMLæˆ–å…¶ä»–å±•ç¤ºä»£ç ï¼Œè¿™äº›ä»£ç æœ€å¥½åœ¨ [è§†å›¾](https://www.yiiframework.com/doc/guide/2.0/zh-cn/structure-views)ä¸­å¤„ç?
