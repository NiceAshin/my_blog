---
date: 2025-11-14 05:31:00
title: Git å¤šä»“åº“åŒæ­¥æœ€ä½³å®è·µï¼šåœ¨ä¸æ“ä½œä¸»ä»“åº“ master çš„å‰æä¸‹è¿›è¡Œè·¨ä»“åº“åˆå¹¶
tags:
  - git
  - workflow
---

# Git å¤šä»“åº“åŒæ­¥æœ€ä½³å®è·µï¼šåœ¨ä¸æ“ä½œä¸»ä»“åº“ master çš„å‰æä¸‹è¿›è¡Œè·¨ä»“åº“åˆå¹¶

> é¢„è®¡é˜…è¯»æ—¶é—´ï¼š6 åˆ†é’Ÿ

åœ¨é¡¹ç›®å®é™…å¼€å‘ä¸­ï¼Œæˆ‘é‡åˆ°è¿‡ä¸€ä¸ªç‰¹æ®Šçš„æƒé™é™åˆ¶ï¼šé¡¹ç›®ç»‘å®šäº†ä¸¤ä¸ª Git ä»“åº“ï¼Œå´åªèƒ½å‘ä¸»ä»“åº“ `origin` çš„ `dev` åˆ†æ”¯æ¨é€ï¼Œå®Œå…¨æ— æ³•è§¦ç¢° `origin/master`ã€‚ä¸æ­¤åŒæ—¶ï¼Œå‰¯ä»“åº“ `guns-gitlab` çš„æœ€æ–°ä»£ç éƒ½åœ¨ `master` ä¸Šã€‚éœ€æ±‚æ˜¯**å°† `guns-gitlab/master` çš„æ›´æ–°å®‰å…¨åœ°åŒæ­¥åˆ° `origin/dev`ï¼Œå¹¶ä¿è¯æ•´ä¸ªè¿‡ç¨‹ä¸æ¥è§¦ `origin/master`**ã€‚

æœ¬æ–‡è®°å½•äº†æœ€ç»ˆé‡‡ç”¨çš„æ–¹æ¡ˆï¼šé€šè¿‡ **æœ¬åœ°è‡ªå»ºåŒæ­¥åˆ†æ”¯ `sync-guns`** ä¸²è”å¤šä»“åº“ï¼Œæ—¢å®‰å…¨å¯æ§ï¼Œåˆä¸ä¼šç ´åä¸»ä»“åº“çš„æƒé™è¾¹ç•Œã€‚

## ğŸ§© é¡¹ç›®è¿œç¨‹ä»“åº“ç»“æ„

æ‰§è¡Œ `git remote -v` å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªè¿œç¨‹ï¼š

```
guns-gitlab     https://git.javaguns.com/... (fetch)
guns-gitlab     https://git.javaguns.com/... (push)
origin          https://gitee.com/funuo/fn-uav.git (fetch)
origin          https://gitee.com/funuo/fn-uav.git (push)
```

## ğŸ” æƒé™é™åˆ¶æ¦‚è§ˆ

| ä»“åº“ | åˆ†æ”¯   | æƒé™è¯´æ˜ |
| ---- | ------ | -------- |
| origin | master | âŒ æ— æƒæ¨é€ / ä¸å…è®¸æ“ä½œ |
| origin | dev    | âœ” å¯æ¨é€ |
| guns-gitlab | master | âœ” æ›´æ–°æ¥æº |

é™åˆ¶çš„é‡ç‚¹åœ¨äºï¼š
- **ä¸èƒ½ checkout `origin/master`**ã€‚
- **ä¸èƒ½åŸºäº `origin/master` åˆ›å»ºä»»ä½•æ–°åˆ†æ”¯**ã€‚

## ğŸ§­ è§£å†³æ–¹æ¡ˆï¼šæœ¬åœ°åŒæ­¥åˆ†æ”¯ `sync-guns`

æ ¸å¿ƒåŒæ­¥é“¾è·¯å¦‚ä¸‹ï¼š

```
guns-gitlab/master  â†’  æœ¬åœ° sync-guns  â†’  æœ¬åœ° dev  â†’  origin/dev
```

é€šè¿‡åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªåªä¸ºåŒæ­¥è€Œç”Ÿçš„ä¸´æ—¶åˆ†æ”¯ï¼Œæ—¢èƒ½å¸æ”¶å‰¯ä»“åº“çš„æ›´æ–°ï¼Œåˆèƒ½åœ¨ç¡®è®¤æ— è¯¯åå†åˆå¹¶è¿›å·¥ä½œåˆ†æ”¯ `dev`ï¼Œå…¨ç¨‹ä¸è§¦ç¢° `origin/master`ã€‚

## ğŸ”§ æ¨èå·¥ä½œæµï¼ˆå¯ç›´æ¥å¤ç”¨ï¼‰

1. **æ‹‰å–ä¸¤ä¸ªè¿œç¨‹çš„æœ€æ–°ä»£ç **
   ```bash
   git fetch origin
   git fetch guns-gitlab
   ```
2. **åˆ‡æ¢åˆ°ä½ çš„å·¥ä½œåˆ†æ”¯ `dev`**
   ```bash
   git checkout dev
   ```
3. **åˆ›å»ºæœ¬åœ°åŒæ­¥åˆ†æ”¯ï¼ˆä¸æ¨é€ï¼‰**
   ```bash
   git checkout -b sync-guns
   ```
   `sync-guns` åªåœ¨æœ¬åœ°å­˜åœ¨ï¼Œä¸ä¼šå½±å“ä»»ä½•è¿œç¨‹ä»“åº“ã€‚
4. **å°† `guns-gitlab/master` åˆå¹¶åˆ° `sync-guns`**
   ```bash
   git merge guns-gitlab/master
   ```
   å‡ºç°å†²çªæ—¶ï¼Œè§£å†³åæ‰§è¡Œï¼š
   ```bash
   git add .
   git commit
   ```
5. **åˆ‡å› `dev`**
   ```bash
   git checkout dev
   ```
6. **æŠŠ `sync-guns` çš„å†…å®¹åˆå¹¶è¿› `dev`**
   ```bash
   git merge sync-guns
   ```
   åŒæ ·å…ˆè§£å†³å†²çªï¼Œå† `git add . && git commit`ã€‚
7. **æ¨é€åˆ° `origin/dev`ï¼Œå®Œæˆè·¨ä»“åŒæ­¥**
   ```bash
   git push origin dev
   ```

è‡³æ­¤ï¼Œ`guns-gitlab/master â†’ origin/dev` çš„åŒæ­¥é“¾è·¯é—­ç¯ã€‚

## ğŸ” å·²æäº¤ä»£ç çš„è·¨ä»“åº“ cherry-pick

æœ‰æ—¶å¹¶ä¸æ˜¯ç®€å•çš„â€œæ•´åˆ†æ”¯åŒæ­¥â€ï¼Œè€Œæ˜¯éœ€è¦æŠŠå‰¯ä»“åº“é‡ŒæŸä¸ªç‰¹å®šæäº¤è·¨ä»“åº“ã€è·¨åˆ†æ”¯åœ°åŒæ­¥è¿‡æ¥ã€‚è¿™æ—¶æ¨èä½¿ç”¨ `git cherry-pick`ï¼š

1. **åœ¨æœ¬åœ°åŒæ­¥åˆ†æ”¯ `sync-guns` ä¸Šè·å–ç›®æ ‡æäº¤**
   ```bash
   git checkout sync-guns
   git fetch guns-gitlab
   git cherry-pick <guns-gitlab-commit>
   ```
2. **å°† cherry-pick ç»“æœåˆå¹¶å› `dev`ï¼Œå†æ¨é€åˆ° `origin/dev`**
   ```bash
   git checkout dev
   git merge sync-guns
   git push origin dev
   ```

> âœ… `git cherry-pick --abort`ï¼šå½“ cherry-pick è¿‡ç¨‹ä¸­å‡ºç°å†²çªæˆ–æƒ³è¦æ”¾å¼ƒæ“ä½œæ—¶ï¼Œä½¿ç”¨è¯¥å‘½ä»¤å¯ç«‹å³å›æ»šåˆ°æ“ä½œå‰çš„çŠ¶æ€ã€‚

ä¸ºäº†æ›´å¿«é”å®šéœ€è¦ cherry-pick çš„æäº¤ï¼Œå¯æ­é…ä¸‹é¢çš„å‘½ä»¤ï¼š

- `git log --oneline --decorate -n 5`ï¼šå¿«é€ŸæŸ¥çœ‹æœ€è¿‘ 5 æ¡æäº¤ã€åˆ†æ”¯æˆ– tag è£…é¥°ä¿¡æ¯ã€‚æŠŠ `-n 5` æ”¹æˆæ›´å¤§çš„æ•°å­—å³å¯æŸ¥çœ‹æ›´å¤šå†å²ã€‚
- `git revert <commit>`ï¼šå¦‚æœè¯¯ cherry-pick äº†æŸä¸ªæäº¤ï¼Œå¯é€šè¿‡ revert å¼•å…¥ä¸€ä¸ªæ–°çš„åå‘æäº¤ï¼Œä»å†å²ä¸­â€œæ’¤é”€â€è¿™æ¬¡å˜æ›´ï¼Œè€Œä¸ä¼šé‡å†™å·²æœ‰æäº¤ã€‚

## ğŸŒˆ åŒæ­¥æµç¨‹ç¤ºæ„å›¾

```
              guns-gitlab/master
                       â†“
         (æœ¬åœ°ä¸´æ—¶åˆ†æ”¯ï¼Œä¸æ¨é€)
            local branch: sync-guns
                       â†“
            merge into local dev
                       â†“
                  origin/dev
```

## ğŸ’¡ ä¸ºä»€ä¹ˆä¸€å®šè¦æœ‰æœ¬åœ°åŒæ­¥åˆ†æ”¯ï¼Ÿ

- âŒ æ— æ³•æ“ä½œ `origin/master`ï¼Œç›´æ¥åœ¨å…¶ä¸Šåˆå¹¶ä¸å¯è¡Œã€‚
- âŒ ä¹Ÿä¸å»ºè®®æŠŠ `guns-gitlab/master` ç›´æ¥åˆè¿› `dev`ï¼Œå¦åˆ™ç¼ºå°‘ç¼“å†²åœ°å¸¦ï¼Œé£é™©å¤§ã€‚
- âœ” æœ¬åœ°åˆ†æ”¯å¯ä»¥è‡ªç”±åˆ›å»º/åˆ é™¤ï¼Œå®‰å…¨åˆå¯æ§ã€‚
- âœ” `sync-guns` éšç”¨éšå»ºï¼Œä¿æŒ `dev` å†å²å¹²å‡€ã€‚

## ğŸ§¹ å¯é€‰æ¸…ç†ï¼šåˆ é™¤ä¸´æ—¶åˆ†æ”¯

åŒæ­¥å®Œæˆåï¼Œå¯åœ¨æœ¬åœ°åˆ é™¤ `sync-guns`ï¼Œä¸‹æ¬¡éœ€è¦æ—¶å†é‡æ–°åˆ›å»ºï¼š

```bash
git branch -d sync-guns
```

## ğŸ“ å®Œæ•´å‘½ä»¤é€ŸæŸ¥è¡¨

```bash
git fetch origin
git fetch guns-gitlab

git checkout dev
git checkout -b sync-guns

git merge guns-gitlab/master   # åˆå¹¶å‰¯ä»“åº“æ›´æ–°
git checkout dev
git merge sync-guns            # å°†æ›´æ–°åˆå…¥ dev

git push origin dev            # æ¨é€åˆ°ä¸»ä»“åº“ dev

# cherry-pick ç›¸å…³
git checkout sync-guns
git cherry-pick <guns-gitlab-commit>
git cherry-pick --abort        # æ”¾å¼ƒå½“å‰ cherry-pick
git log --oneline --decorate -n 5
git revert <commit>            # å¼•å…¥åå‘æäº¤æ’¤é”€å†å²
```

## ğŸ“ æ€»ç»“

åœ¨ä¸èƒ½è§¦ç¢° `origin/master` çš„å‰æä¸‹ï¼Œ**â€œæœ¬åœ°åŒæ­¥åˆ†æ”¯ â†’ å·¥ä½œåˆ†æ”¯ â†’ å¯æ¨é€çš„è¿œç¨‹åˆ†æ”¯â€** æ˜¯æœ€ç¨³å¦¥çš„è·¨ä»“åº“åŒæ­¥æ¨¡å¼ï¼š

- âœ” å®Œå…¨éµå®ˆæƒé™è¾¹ç•Œã€‚
- âœ” æœ¬åœ°å¯ä»¥éšæ—¶å›æ»šæˆ–é‡å»ºåŒæ­¥åˆ†æ”¯ã€‚
- âœ” æäº¤æµç¨‹å®‰å…¨ã€å¯æ§ï¼Œä¸”ä¸ä¼šå¹²æ‰°å›¢é˜Ÿå…¶ä»–æˆå‘˜ã€‚

ä¸‹æ¬¡é‡åˆ°å¤šè¿œç¨‹ä»“åº“ã€ä¸»ä»“åº“å—é™çš„åœºæ™¯ï¼Œå°±æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œå³å¯ã€‚
